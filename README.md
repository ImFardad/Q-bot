# ربات تلگرام هوشمند Q-Bot (Node.js)

این پروژه یک ربات تلگرام است که با استفاده از Node.js، کتابخانه `node-telegram-bot-api` و مدل هوش مصنوعی Gemini گوگل ساخته شده است. ربات قابلیت پرسش و پاسخ (کوئیز) دارد و از تکرار سوالات برای هر کاربر در ۲۴ ساعت گذشته جلوگیری می‌کند. همچنین دارای پنل مدیریت برای ادمین است.

---

## قابلیت‌ها

- **کوئیز هوشمند:** تولید سوالات اطلاعات عمومی با استفاده از Gemini.
- **جلوگیری از تکرار:** ربات سوالاتی که از هر کاربر در ۲۴ ساعت گذشته پرسیده را به خاطر می‌سپارد.
- **پنل ادمین:** قابلیت‌های مدیریتی برای کاربر ادمین.
- **ناوبری تو در تو:** منوهای روان با قابلیت بازگشت به مرحله قبل.
- **کدنویسی استاندارد:** استفاده از ESLint برای حفظ کیفیت کد و Husky برای اجرای خودکار لینتر قبل از هر کامیت.

---

## ساختار پروژه

```
telegram-bot/
│
├── .husky/                 # تنظیمات Git Hooks (Husky)
│   └── pre-commit          # اسکریپت قبل از کامیت
│
├── db/
│   ├── database.js         # تنظیمات اتصال به دیتابیس (Sequelize)
│   ├── User.js             # مدل کاربر
│   └── UserQuestionHistory.js # مدل تاریخچه سوالات کاربر
│
├── handlers/               # مدیریت رویدادها و پیام‌ها
│   ├── menuHandler.js
│   ├── quizHandler.js
│   └── startHandler.js
│
├── keyboards/
│   └── inlineKeyboards.js  # ساخت کیبوردهای داینامیک
│
├── services/
│   └── geminiService.js    # سرویس ارتباط با Gemini AI
│
├── .env                    # فایل متغیرهای محیطی
├── eslint.config.js        # تنظیمات لینتر
├── bot.js                  # منطق اصلی و راه‌اندازی ربات
├── config.js               # بارگذاری متغیرها از .env
├── index.js                # نقطه شروع برنامه
├── package.json
└── README.md
```

---

## راه‌اندازی و نصب

### ۱. پیش‌نیازها
- [Node.js](https://nodejs.org/) نسخه ۱۸ یا بالاتر

### ۲. نصب نیازمندی‌ها
```sh
npm install
```

---

## پیکربندی

فایل `.env` را در ریشه پروژه ایجاد کرده و مقادیر زیر را در آن قرار دهید:

```env
# توکن ربات تلگرام دریافتی از BotFather
TELEGRAM_TOKEN="YOUR_TELEGRAM_TOKEN"

# کلید API برای سرویس Gemini گوگل
GEMINI_API_KEY="YOUR_GEMINI_API_KEY"

# شناسه عددی کاربری که ادمین ربات خواهد بود
ADMIN_USER_ID="YOUR_TELEGRAM_USER_ID"
```
- برای پیدا کردن شناسه کاربری خود، می‌توانید به ربات [userinfobot](https://t.me/userinfobot) پیام دهید.

---

## اجرای ربات

برای اجرای ربات در حالت توسعه (با Nodemon):
```sh
npm run dev
```
برای اجرای ربات در حالت عادی:
```sh
node index.js
```

---

## توسعه و کیفیت کد

این پروژه از ابزارهای زیر برای تضمین کیفیت کد استفاده می‌کند:
- **ESLint:** برای بررسی و یکپارچه‌سازی استایل کد. می‌توانید با دستور `npm run lint` آن را اجرا کنید.
- **Husky:** قبل از هر کامیت، به صورت خودکار لینتر را اجرا می‌کند تا از ورود کد ناسالم به پروژه جلوگیری شود.